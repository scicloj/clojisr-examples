<!DOCTYPE html>
<html><html><head><script language="JavaScript">
  socket= new WebSocket('ws://localhost:5678/watch-reload');
  socket.onopen= function() {
                           socket.send ('watch') ;
                           };
  socket.onmessage= function(s) {
                               if                                                          ( s.data == 'started') {
                                                                                                                   console.log ("Watching started") ;
                                                                                                                   }                                 else                   if ( s.data == 'reload') {
                                                                                                                                                                                                      console.log            ("reloading") ;
                                                                                                                                                                                                      window.location.reload ()            ;
                                                                                                                                                                                                      } else                   {
                                                                                                                                                                                                                                alert('Don\'t know what to do with [' + s.data + ']');
                                                                                                                                                                                                                                }
                               };
  </script>
  <style type="text/css">body {
    background-image: linear-gradient(0deg, #fff4e8 25%, #fef8e9 25%, #fef8e9 50%, #fff4e8 50%, #fff4e8 75%, #fef8e9 75%, #fef8e9 100%);
    background-size: 32.00px 32.00px;
    color: #3e3c3f;
    font-family: "Source Sans Pro", sans-serif;
    font-size: 14px;
    padding-left: 10px;
    padding-right: 10px;
    margin: 0;
}

.nspin {
    border-radius: 10px;
    background: #d7d2c3;
    padding: 10px;
    margin-bottom: 5px;
}

.nspout {
    border-radius: 10px;
    background: #e4ded0;
    padding: 10px;
    margin-left: 10px;
}

.nspbox {
    padding-bottom: 5px;
    margin: 0;
}

.FAILED { color: #bb0000; }
.PASSED { color: #009500; }

p {
    margin-top: 0;
    margin-bottom: 5px; }

h1, h2, h3, h4, h5, h6 {
    margin-top: 10px;
    margin-bottom: 5px;
    color: #720000;
}

a:visited { color: #5E5E59; }
a:link { color: #720000; }
tr:nth-child(even) { background-color: #e4ded0; }
th { background-color: #d7d2c3; }

</style><script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/lang-clj.js" type="text/javascript"></script><link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" /><script src="https://code.jquery.com/jquery-3.4.1.min.js" type="text/javascript"></script><script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" type="text/javascript"></script><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css" /></head><body><div><h1>clojisr-examples.mlr3</h1><div><i><small><a href="https://github.com/scicloj/clojisr-examples/tree/master/src/clojisr_examples/mlr3.clj">clojisr-examples.mlr3</a> - created by <a href="https://github.com/scicloj/notespace">notespace</a>, Thu Jul 09 12:55:48 CEST 2020.</small></i><hr /></div><div class="nspbox"><div><h1>MLR3 package usage example.</h1></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(require&nbsp;'[clojisr.v1.r&nbsp;:as&nbsp;r&nbsp;:refer</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[r+&nbsp;r*&nbsp;r&nbsp;r->clj&nbsp;clj->r&nbsp;clj->java&nbsp;java->clj&nbsp;java->r&nbsp;r->java]]</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'[clojisr.v1.require&nbsp;:refer&nbsp;[require-r]]</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'[clojisr.v1.applications.plotting&nbsp;:refer&nbsp;[plot->file]])</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(require-r&nbsp;'[base&nbsp;:as&nbsp;base&nbsp;:refer&nbsp;[$]]&nbsp;'[mlr3&nbsp;:as&nbsp;mlr3])</code></div></div><div class="nspbox"><div><h2>create task and learner object</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;task-iris</br>&nbsp;&nbsp;&nbsp;(($&nbsp;mlr3/TaskClassif&nbsp;'new)</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:id</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iris"</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:backend</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'iris</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:target</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Species"))</code></div><div class="nspout"><code class="prettyprint lang-clj"><TaskClassif:iris>&nbsp;(150&nbsp;x&nbsp;5)</br>*&nbsp;Target:&nbsp;Species</br>*&nbsp;Properties:&nbsp;multiclass</br>*&nbsp;Features&nbsp;(4):</br>&nbsp;&nbsp;-&nbsp;dbl&nbsp;(4):&nbsp;Petal.Length,&nbsp;Petal.Width,&nbsp;Sepal.Length,&nbsp;Sepal.Width</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;learner&nbsp;(mlr3/lrn&nbsp;"classif.rpart"&nbsp;:cp&nbsp;0.01))</code></div><div class="nspout"><code class="prettyprint lang-clj"><LearnerClassifRpart:classif.rpart></br>*&nbsp;Model:&nbsp;-</br>*&nbsp;Parameters:&nbsp;xval=0,&nbsp;cp=0.01</br>*&nbsp;Packages:&nbsp;rpart</br>*&nbsp;Predict&nbsp;Type:&nbsp;response</br>*&nbsp;Feature&nbsp;types:&nbsp;logical,&nbsp;integer,&nbsp;numeric,&nbsp;factor,&nbsp;ordered</br>*&nbsp;Properties:&nbsp;importance,&nbsp;missings,&nbsp;multiclass,&nbsp;selected_features,</br>&nbsp;&nbsp;twoclass,&nbsp;weights</code></div></div><div class="nspbox"><div><h2>train and test sets</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;train-set</br>&nbsp;&nbsp;&nbsp;(base/sample&nbsp;($&nbsp;task-iris&nbsp;'nrow)&nbsp;(r*&nbsp;0.8&nbsp;($&nbsp;task-iris&nbsp;'nrow))))</code></div><div class="nspout"><code class="prettyprint lang-clj">&nbsp;&nbsp;[1]&nbsp;&nbsp;38&nbsp;&nbsp;11&nbsp;&nbsp;29&nbsp;131&nbsp;&nbsp;24&nbsp;&nbsp;67&nbsp;&nbsp;31&nbsp;123&nbsp;115&nbsp;&nbsp;96&nbsp;114&nbsp;137&nbsp;138&nbsp;136&nbsp;139&nbsp;111&nbsp;&nbsp;13&nbsp;&nbsp;66</br>&nbsp;[19]&nbsp;140&nbsp;&nbsp;80&nbsp;&nbsp;51&nbsp;150&nbsp;&nbsp;63&nbsp;143&nbsp;120&nbsp;&nbsp;47&nbsp;&nbsp;89&nbsp;&nbsp;12&nbsp;100&nbsp;145&nbsp;&nbsp;86&nbsp;&nbsp;25&nbsp;&nbsp;78&nbsp;&nbsp;77&nbsp;&nbsp;46&nbsp;&nbsp;85</br>&nbsp;[37]&nbsp;&nbsp;69&nbsp;&nbsp;62&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;92&nbsp;&nbsp;99&nbsp;144&nbsp;&nbsp;41&nbsp;&nbsp;73&nbsp;148&nbsp;124&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;64&nbsp;141&nbsp;&nbsp;58&nbsp;&nbsp;65&nbsp;&nbsp;71&nbsp;118</br>&nbsp;[55]&nbsp;&nbsp;40&nbsp;&nbsp;19&nbsp;107&nbsp;101&nbsp;&nbsp;30&nbsp;&nbsp;88&nbsp;&nbsp;21&nbsp;134&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;94&nbsp;&nbsp;39&nbsp;&nbsp;54&nbsp;147&nbsp;&nbsp;43&nbsp;&nbsp;75&nbsp;&nbsp;72&nbsp;&nbsp;76&nbsp;&nbsp;87</br>&nbsp;[73]&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;32&nbsp;105&nbsp;&nbsp;90&nbsp;126&nbsp;&nbsp;44&nbsp;129&nbsp;&nbsp;23&nbsp;102&nbsp;149&nbsp;&nbsp;68&nbsp;&nbsp;36&nbsp;&nbsp;57&nbsp;&nbsp;22&nbsp;122&nbsp;&nbsp;98&nbsp;&nbsp;79&nbsp;108</br>&nbsp;[91]&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;91&nbsp;119&nbsp;&nbsp;55&nbsp;130&nbsp;121&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;26&nbsp;116&nbsp;&nbsp;37&nbsp;&nbsp;27&nbsp;109&nbsp;&nbsp;82&nbsp;&nbsp;70&nbsp;&nbsp;83&nbsp;&nbsp;28&nbsp;127</br>[109]&nbsp;142&nbsp;&nbsp;53&nbsp;&nbsp;45&nbsp;113&nbsp;&nbsp;10&nbsp;&nbsp;49&nbsp;&nbsp;97&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;35&nbsp;&nbsp;84&nbsp;&nbsp;95&nbsp;110</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;test-set</br>&nbsp;&nbsp;&nbsp;(base/setdiff&nbsp;(base/seq_len&nbsp;($&nbsp;task-iris&nbsp;'nrow))&nbsp;train-set))</code></div><div class="nspout"><code class="prettyprint lang-clj">&nbsp;[1]&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;14&nbsp;&nbsp;15&nbsp;&nbsp;16&nbsp;&nbsp;17&nbsp;&nbsp;18&nbsp;&nbsp;20&nbsp;&nbsp;33&nbsp;&nbsp;34&nbsp;&nbsp;42&nbsp;&nbsp;48&nbsp;&nbsp;50&nbsp;&nbsp;52&nbsp;&nbsp;59&nbsp;&nbsp;60&nbsp;&nbsp;61&nbsp;&nbsp;74&nbsp;&nbsp;81&nbsp;&nbsp;93</br>[20]&nbsp;103&nbsp;104&nbsp;106&nbsp;112&nbsp;117&nbsp;125&nbsp;128&nbsp;132&nbsp;133&nbsp;135&nbsp;146</code></div></div><div class="nspbox"><div><h2>train</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(($&nbsp;learner&nbsp;'train)&nbsp;task-iris&nbsp;:row_ids&nbsp;train-set)</code></div><div class="nspout"><code class="prettyprint lang-clj"><LearnerClassifRpart:classif.rpart></br>*&nbsp;Model:&nbsp;rpart</br>*&nbsp;Parameters:&nbsp;xval=0,&nbsp;cp=0.01</br>*&nbsp;Packages:&nbsp;rpart</br>*&nbsp;Predict&nbsp;Type:&nbsp;response</br>*&nbsp;Feature&nbsp;types:&nbsp;logical,&nbsp;integer,&nbsp;numeric,&nbsp;factor,&nbsp;ordered</br>*&nbsp;Properties:&nbsp;importance,&nbsp;missings,&nbsp;multiclass,&nbsp;selected_features,</br>&nbsp;&nbsp;twoclass,&nbsp;weights</code></div></div><div class="nspbox"><div><h2>predict</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;prediction&nbsp;(($&nbsp;learner&nbsp;'predict)&nbsp;task-iris&nbsp;:row_ids&nbsp;test-set))</code></div><div class="nspout"><code class="prettyprint lang-clj"><PredictionClassif>&nbsp;for&nbsp;30&nbsp;observations:</br>&nbsp;&nbsp;&nbsp;&nbsp;row_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truth&nbsp;&nbsp;&nbsp;response</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa</br>---&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;133&nbsp;virginica&nbsp;&nbsp;virginica</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;135&nbsp;virginica&nbsp;versicolor</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;146&nbsp;virginica&nbsp;&nbsp;virginica</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">($&nbsp;prediction&nbsp;'confusion)</code></div><div class="nspout"><code class="prettyprint lang-clj">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truth</br>response&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;versicolor&nbsp;virginica</br>&nbsp;&nbsp;setosa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</br>&nbsp;&nbsp;versicolor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</br>&nbsp;&nbsp;virginica&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(r->clj&nbsp;($&nbsp;prediction&nbsp;'confusion))</code></div><div class="nspout"><code class="prettyprint lang-clj">_unnamed&nbsp;[9&nbsp;3]:</br></br>|&nbsp;&nbsp;:response&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:truth&nbsp;|&nbsp;:$value&nbsp;|</br>|------------|------------|--------:|</br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;|</br>|&nbsp;versicolor&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|</br>|&nbsp;&nbsp;virginica&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|</br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;versicolor&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|</br>|&nbsp;versicolor&nbsp;|&nbsp;versicolor&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;|</br>|&nbsp;&nbsp;virginica&nbsp;|&nbsp;versicolor&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|</br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setosa&nbsp;|&nbsp;&nbsp;virginica&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|</br>|&nbsp;versicolor&nbsp;|&nbsp;&nbsp;virginica&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|</br>|&nbsp;&nbsp;virginica&nbsp;|&nbsp;&nbsp;virginica&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;|</code></div></div><div class="nspbox"><div><h2>check accuracy</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;measure&nbsp;(mlr3/msr&nbsp;"classif.acc"))</code></div><div class="nspout"><code class="prettyprint lang-clj"><MeasureClassifSimple:classif.acc></br>*&nbsp;Packages:&nbsp;mlr3measures</br>*&nbsp;Range:&nbsp;[0,&nbsp;1]</br>*&nbsp;Minimize:&nbsp;FALSE</br>*&nbsp;Properties:&nbsp;-</br>*&nbsp;Predict&nbsp;type:&nbsp;response</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(($&nbsp;prediction&nbsp;'score)&nbsp;measure)</code></div><div class="nspout"><code class="prettyprint lang-clj">classif.acc&nbsp;</br>&nbsp;&nbsp;0.9666667&nbsp;</code></div></div><div class="nspbox"><div><h2>cross-validation</h2></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;resampling&nbsp;(mlr3/rsmp&nbsp;"cv"&nbsp;:folds&nbsp;3))</code></div><div class="nspout"><code class="prettyprint lang-clj"><ResamplingCV>&nbsp;with&nbsp;3&nbsp;iterations</br>*&nbsp;Instantiated:&nbsp;FALSE</br>*&nbsp;Parameters:&nbsp;folds=3</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(def&nbsp;rr&nbsp;(mlr3/resample&nbsp;task-iris&nbsp;learner&nbsp;resampling))</code></div><div class="nspout"><code class="prettyprint lang-clj"><ResampleResult>&nbsp;of&nbsp;3&nbsp;iterations</br>*&nbsp;Task:&nbsp;iris</br>*&nbsp;Learner:&nbsp;classif.rpart</br>*&nbsp;Warnings:&nbsp;0&nbsp;in&nbsp;0&nbsp;iterations</br>*&nbsp;Errors:&nbsp;0&nbsp;in&nbsp;0&nbsp;iterations</code></div></div><div class="nspbox"><div class="nspin"><code class="prettyprint lang-clj">(($&nbsp;rr&nbsp;'aggregate)&nbsp;measure)</code></div><div class="nspout"><code class="prettyprint lang-clj">classif.acc&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.94&nbsp;</code></div></div><hr /><div><i><small><a href="https://github.com/scicloj/clojisr-examples/tree/master/src/clojisr_examples/mlr3.clj">clojisr-examples.mlr3</a> - created by <a href="https://github.com/scicloj/notespace">notespace</a>, Thu Jul 09 12:55:48 CEST 2020.</small></i><hr /></div></div></body></html></html>